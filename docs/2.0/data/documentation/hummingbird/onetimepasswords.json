{"kind":"article","topicSections":[{"identifiers":["doc:\/\/com.opticalaberration.hummingbird\/documentation\/HummingbirdAuth\/HOTP","doc:\/\/com.opticalaberration.hummingbird\/documentation\/HummingbirdAuth\/TOTP"],"title":"Reference"}],"seeAlsoSections":[{"identifiers":["doc:\/\/com.opticalaberration.hummingbird\/documentation\/Hummingbird\/AuthenticatorMiddleware","doc:\/\/com.opticalaberration.hummingbird\/documentation\/Hummingbird\/Sessions"],"title":"Articles","generated":true}],"schemaVersion":{"patch":0,"major":0,"minor":3},"metadata":{"title":"One Time Passwords","modules":[{"name":"HummingbirdAuth"}],"role":"collectionGroup"},"hierarchy":{"paths":[["doc:\/\/com.opticalaberration.hummingbird\/documentation\/HummingbirdAuth"],["doc:\/\/com.opticalaberration.hummingbird\/documentation\/index"]]},"primaryContentSections":[{"content":[{"level":2,"anchor":"Overview","type":"heading","text":"Overview"},{"inlineContent":[{"type":"text","text":"OTPs avoid a number of shortcomings that are associated with traditional (static) password-based authentication. OTP generation algorithms typically make use of pseudorandomness or randomness, making prediction of successor OTPs by an attacker difficult, and also cryptographic hash functions, which can be used to derive a value but are hard to reverse and therefore difficult for an attacker to obtain the data that was used for the hash. This is necessary because otherwise it would be easy to predict future OTPs by observing previous ones."}],"type":"paragraph"},{"inlineContent":[{"type":"text","text":"HummingbirdAuth provides support for both time based ("},{"isActive":true,"type":"reference","identifier":"doc:\/\/com.opticalaberration.hummingbird\/documentation\/HummingbirdAuth\/TOTP"},{"type":"text","text":") and counter based ("},{"type":"reference","isActive":true,"identifier":"doc:\/\/com.opticalaberration.hummingbird\/documentation\/HummingbirdAuth\/HOTP"},{"type":"text","text":") one time passwords."}],"type":"paragraph"},{"level":2,"anchor":"Usage","type":"heading","text":"Usage"},{"inlineContent":[{"text":"To setup one time password authentication you need a shared secret for each user. Store the shared secret with your user in a database. You can generate an authentication URL to supply to the user which includes a base32 encoded version of the shared secret.","type":"text"}],"type":"paragraph"},{"code":["\/\/ create shared secret","let sharedSecret = \"random string\"","\/\/ store shared secret in database alongside user","storeSecretWithUser(secret: sharedSecret)","\/\/ create TOTP and generate authenticaion URL","let totp = TOTP(secret: sharedSecret)","let authenticationURL = totp.createAuthenticatorURL(label: \"MyURL\")"],"type":"codeListing","syntax":"swift"},{"inlineContent":[{"text":"Generally this is provided to the user via a QR Code. Most phones will automatically open up an Authenticator app to store the URL when they scan the QR Code.","type":"text"}],"type":"paragraph"},{"level":2,"anchor":"Authenticating","type":"heading","text":"Authenticating"},{"inlineContent":[{"type":"text","text":"Compute the time based one time password as follows"}],"type":"paragraph"},{"code":["let password = TOTP(secret: sharedSecret).compute()"],"type":"codeListing","syntax":"swift"},{"inlineContent":[{"type":"text","text":"Compare it with the password provided by the user to verify the user credentials."}],"type":"paragraph"}],"kind":"content"}],"abstract":[{"type":"text","text":"A one time password (OTP) valid for only one login session."}],"identifier":{"interfaceLanguage":"swift","url":"doc:\/\/com.opticalaberration.hummingbird\/documentation\/Hummingbird\/OneTimePasswords"},"sections":[],"references":{"doc://com.opticalaberration.hummingbird/documentation/HummingbirdAuth":{"abstract":[{"type":"text","text":"Authentication framework and extensions for Hummingbird."}],"identifier":"doc:\/\/com.opticalaberration.hummingbird\/documentation\/HummingbirdAuth","role":"collection","url":"\/documentation\/hummingbirdauth","type":"topic","kind":"symbol","title":"HummingbirdAuth"},"doc://com.opticalaberration.hummingbird/documentation/HummingbirdAuth/HOTP":{"fragments":[{"kind":"keyword","text":"struct"},{"kind":"text","text":" "},{"kind":"identifier","text":"HOTP"}],"url":"\/documentation\/hummingbirdauth\/hotp","navigatorTitle":[{"kind":"identifier","text":"HOTP"}],"role":"symbol","kind":"symbol","identifier":"doc:\/\/com.opticalaberration.hummingbird\/documentation\/HummingbirdAuth\/HOTP","abstract":[{"text":"A counter based one time password (OTP)","type":"text"}],"type":"topic","title":"HOTP"},"doc://com.opticalaberration.hummingbird/documentation/Hummingbird/Sessions":{"abstract":[{"type":"text","text":"Session based authentication"}],"role":"collectionGroup","type":"topic","title":"Sessions","identifier":"doc:\/\/com.opticalaberration.hummingbird\/documentation\/Hummingbird\/Sessions","kind":"article","url":"\/documentation\/hummingbird\/sessions"},"doc://com.opticalaberration.hummingbird/documentation/index":{"identifier":"doc:\/\/com.opticalaberration.hummingbird\/documentation\/index","kind":"article","title":"Hummingbird","type":"topic","abstract":[{"type":"text","text":"Lightweight, flexible, modern server framework written in Swift."}],"role":"collection","url":"\/documentation\/index"},"doc://com.opticalaberration.hummingbird/documentation/Hummingbird/AuthenticatorMiddleware":{"kind":"article","type":"topic","url":"\/documentation\/hummingbird\/authenticatormiddleware","abstract":[{"text":"Request authentication middleware","type":"text"}],"role":"collectionGroup","title":"Authenticator Middleware","identifier":"doc:\/\/com.opticalaberration.hummingbird\/documentation\/Hummingbird\/AuthenticatorMiddleware"},"doc://com.opticalaberration.hummingbird/documentation/HummingbirdAuth/TOTP":{"url":"\/documentation\/hummingbirdauth\/totp","title":"TOTP","abstract":[{"text":"A time based one time password (OTP)","type":"text"}],"type":"topic","navigatorTitle":[{"kind":"identifier","text":"TOTP"}],"identifier":"doc:\/\/com.opticalaberration.hummingbird\/documentation\/HummingbirdAuth\/TOTP","kind":"symbol","role":"symbol","fragments":[{"kind":"keyword","text":"struct"},{"kind":"text","text":" "},{"kind":"identifier","text":"TOTP"}]}}}