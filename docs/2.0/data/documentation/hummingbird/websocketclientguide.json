{"kind":"article","primaryContentSections":[{"content":[{"anchor":"overview","level":2,"text":"Overview","type":"heading"},{"inlineContent":[{"type":"text","text":"A WebSocket connection is only setup after an initial HTTP upgrade request has been sent. "},{"identifier":"doc:\/\/com.opticalaberration.hummingbird\/documentation\/HummingbirdWebSocket\/WebSocketClient","type":"reference","isActive":true},{"type":"text","text":" manages the process of sending the initial HTTP request and then the handling of the WebSocket once it has been upgraded."}],"type":"paragraph"},{"anchor":"Setup","level":2,"text":"Setup","type":"heading"},{"inlineContent":[{"text":"A WebSocket client is created with the server URL, a closure to handle the connection and optional configuration values. To connect call ","type":"text"},{"type":"reference","identifier":"doc:\/\/com.opticalaberration.hummingbird\/documentation\/HummingbirdWebSocket\/WebSocketClient\/run()","isActive":true},{"text":". This will exit once the WebSocket connection has closed.","type":"text"}],"type":"paragraph"},{"code":["let ws = WebSocketClient(URI(\"ws:\/\/mywebsocket\/ws\")) { inbound, outbound, context in","    try await outbound.write(.text(\"Hello\"))","    for try await frame in inbound {","        context.logger.info(frame)","    }","}","try await ws.run()"],"syntax":"swift","type":"codeListing"},{"inlineContent":[{"text":"As a shortcut you can call the following which will initialize and run the WebSocket client in one function call","type":"text"}],"type":"paragraph"},{"code":["try await WebSocketClient.connect(URI(\"ws:\/\/mywebsocket\/ws\")) { inbound, outbound, context in","    try await outbound.write(.text(\"Hello\"))","    for try await frame in inbound {","        context.logger.info(frame)","    }","}"],"syntax":"swift","type":"codeListing"},{"inlineContent":[{"type":"codeVoice","code":"WebSocketClient"},{"type":"text","text":" supports unencrypted and TLS connections. These are indicated via the URL scheme: "},{"type":"codeVoice","code":"ws"},{"type":"text","text":" and "},{"type":"codeVoice","code":"wss"},{"type":"text","text":" respectively. If you provide an "},{"type":"codeVoice","code":"NIOTSEventLoopGroup"},{"type":"text","text":" for the "},{"type":"codeVoice","code":"EventLoopGroup"},{"type":"text","text":" at initialization then client will use the Network.framework to setup the WebSocket connection."}],"type":"paragraph"},{"anchor":"Handler","level":2,"text":"Handler","type":"heading"},{"inlineContent":[{"type":"text","text":"The handler closure works exactly like the WebSocket server handler. You are provided with a inbound sequence of messages and an outbound WebSocket frame writer. The connection will close as sooon as you exit the function. PING, PONG and CLOSE frames are all dealt with internally. If you want to send a regular PING keep-alive you can control that via the WebSocket configuration. By default clients do not send a regular PING. Data and text messages split across multiple frames are collated automatically."}],"type":"paragraph"},{"anchor":"Reference","level":2,"text":"Reference","type":"heading"},{"items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"reference","identifier":"doc:\/\/com.opticalaberration.hummingbird\/documentation\/HummingbirdWebSocket\/WebSocketClient","isActive":true}]}]}],"type":"unorderedList"}],"kind":"content"}],"abstract":[{"type":"text","text":"Connecting to WebSocket servers."}],"identifier":{"interfaceLanguage":"swift","url":"doc:\/\/com.opticalaberration.hummingbird\/documentation\/Hummingbird\/WebSocketClientGuide"},"sections":[],"metadata":{"roleHeading":"Article","role":"article","modules":[{"name":"HummingbirdWebSocket"}],"title":"WebSocket Client"},"schemaVersion":{"patch":0,"major":0,"minor":3},"hierarchy":{"paths":[["doc:\/\/com.opticalaberration.hummingbird\/documentation\/HummingbirdWebSocket"]]},"seeAlsoSections":[{"identifiers":["doc:\/\/com.opticalaberration.hummingbird\/documentation\/Hummingbird\/WebSocketServerUpgrade"],"generated":true,"title":"Guides"}],"references":{"doc://com.opticalaberration.hummingbird/documentation/HummingbirdWebSocket/WebSocketClient":{"title":"WebSocketClient","abstract":[{"type":"text","text":"WebSocket client"}],"type":"topic","role":"symbol","navigatorTitle":[{"kind":"identifier","text":"WebSocketClient"}],"identifier":"doc:\/\/com.opticalaberration.hummingbird\/documentation\/HummingbirdWebSocket\/WebSocketClient","kind":"symbol","fragments":[{"kind":"keyword","text":"struct"},{"kind":"text","text":" "},{"kind":"identifier","text":"WebSocketClient"}],"url":"\/documentation\/hummingbirdwebsocket\/websocketclient"},"doc://com.opticalaberration.hummingbird/documentation/Hummingbird/WebSocketServerUpgrade":{"type":"topic","kind":"article","title":"WebSocket Server Upgrade","abstract":[{"type":"text","text":"Support for upgrading HTTP1 connections to WebSocket."}],"identifier":"doc:\/\/com.opticalaberration.hummingbird\/documentation\/Hummingbird\/WebSocketServerUpgrade","role":"article","url":"\/documentation\/hummingbird\/websocketserverupgrade"},"doc://com.opticalaberration.hummingbird/documentation/HummingbirdWebSocket":{"url":"\/documentation\/hummingbirdwebsocket","abstract":[{"type":"text","text":"Adds support for upgrading HTTP connections to WebSocket."}],"identifier":"doc:\/\/com.opticalaberration.hummingbird\/documentation\/HummingbirdWebSocket","title":"HummingbirdWebSocket","kind":"symbol","role":"collection","type":"topic"},"doc://com.opticalaberration.hummingbird/documentation/HummingbirdWebSocket/WebSocketClient/run()":{"type":"topic","kind":"symbol","title":"run()","abstract":[{"type":"text","text":"Connect and run handler"}],"identifier":"doc:\/\/com.opticalaberration.hummingbird\/documentation\/HummingbirdWebSocket\/WebSocketClient\/run()","fragments":[{"kind":"keyword","text":"func"},{"kind":"text","text":" "},{"kind":"identifier","text":"run"},{"kind":"text","text":"() "},{"kind":"keyword","text":"async"},{"kind":"text","text":" "},{"kind":"keyword","text":"throws"}],"role":"symbol","url":"\/documentation\/hummingbirdwebsocket\/websocketclient\/run()"}}}